Comment from 03.10.2011:

I made one modification to be able to build the code in VS2010.
The modification was because of a compile error. In the code, the loop variable "j" was used outside of the loop, which interestingly didn't cause any problems for the compiler 
I was using back then. I only defined the variable outside of the loop not to alter the original code much, but probably this shouldn't have implemented like that at first, 
so some bugs may exist in the code.